# 批次效应校正与可视化分析

## 数据准备

### 数据源

- **文件名**: `GSE56081.csv`, `GSE23130.csv`
- **内容**: 包含基因表达数据，其中第一列为基因名称，后续列为样本表达值。

### 数据读取

- 使用 `read.csv` 函数读取两个数据集，并提取共同基因的数据。

### 数据预处理

#### 数据合并

1. 读取两个数据集（GSE56081组和GSE23130组）。
2. 获取两个数据集的共同基因列表。
3. 提取共同基因的数据，并合并为一个数据矩阵。

#### 批次信息

- 创建批次信息，标记每个样本所属的数据集（`GSE56081` 或 `GSE23130`）。

---

## 数据可视化

### 箱线图

- **绘制原始数据的彩色箱线图**，展示不同批次的表达分布。
- **文件名**: `boxplot_combined_data_colored.png`

---

## 批次效应校正

### 校正方法

- 使用 **ComBat 方法** 对批次效应进行校正。

### 数据可视化

#### 箱线图

- **绘制校正后的彩色箱线图**，展示批次效应校正效果。
- **文件名**: `boxplot_data_colored.png`

#### 保存校正数据

- 将校正后的数据保存为 CSV 文件。
- **文件名**: `batch_corrected_data.csv`

---

## 数据可视化

### PCA 分析

#### 函数: `perform_pca`

- **功能**:
  - 对数据进行 PCA 分析，支持对数据进行标准化处理。

#### 函数: `create_pca_plot`

- **功能**:
  - 绘制 PCA 图，展示样本在不同批次之间的分布。
  - 支持添加置信椭圆、自定义颜色和图形样式。

---

### 图形生成

#### 原始数据 PCA 图

- **文件名**: `PCA_Before_Correction.png`

#### 校正后数据 PCA 图

- **文件名**: `PCA_After_Correction.png`

---

## 输出文件

### 图形文件

- **文件名**: `boxplot_combined_data_colored.png`
  - **内容**: 原始数据的彩色箱线图。
- **文件名**: `boxplot_data_colored.png`
  - **内容**: 批次校正后的彩色箱线图。
- **文件名**: `PCA_Before_Correction.png`
  - **内容**: 原始数据的 PCA 图。
- **文件名**: `PCA_After_Correction.png`
  - **内容**: 批次校正后的 PCA 图。

### 数据文件

- **文件名**: `batch_corrected_data.csv`
  - **内容**: 批次校正后的基因表达数据。

---

## 备注

- 所有输出文件默认保存在当前工作目录。
